import{d as b,c as a,a as w,g,t as f,i as x,r as v,w as E}from"./web.ldtFZsFK.js";import{t as o}from"./toast.Jx87NQpg.js";import"./store.CO7NX3KL.js";var p=f('<button class="btn btn-wide font-serif bg-gradient-to-r from-sky-500 to-indigo-500 hover:from-sky-600 hover:to-indigo-600 text-white active:scale-95 transition-all duration-200 rounded-lg shadow-md dark:from-sky-700 dark:to-indigo-900 dark:hover:from-sky-800 dark:hover:to-indigo-950 dark:text-white">'),$=f('<button class="btn btn-wide font-serif bg-gray-200 text-gray-500 cursor-not-allowed dark:bg-gray-800 dark:text-gray-400">已加载全部文章');const C=e=>{const[u,n]=a(!1),[r,m]=a(e.currentPage),[h,s]=a(!e.next),i=()=>r()*e.size<e.total;async function y(){if(!e.next||!i()){s(!0);return}n(!0);try{const t=await fetch(`/${r()+1}`);if(!t.ok){o.error("加载失败");return}const k=await t.text(),c=new DOMParser().parseFromString(k,"text/html").querySelector("[data-article-list]");if(!c){o.error("解析内容失败");return}const l=document.querySelector("[data-article-list]");l&&Array.from(c.childNodes).forEach(d=>{d.nodeType===Node.ELEMENT_NODE&&l.appendChild(d)}),m(r()+1),i()||s(!0)}catch(t){console.error("加载更多文章失败",t),o.error("加载失败")}finally{n(!1)}}return w(E,{get when(){return!h()},get fallback(){return g($)},get children(){var t=g(p);return t.$$click=y,x(t,()=>u()?"加载中...":"加载更多文章"),v(),t}})};b(["click"]);export{C as default};
